---
layout: post
title: "Traccia 16 Dicembre 2025"
date: 2025-12-16
---

## Sistema di Gestione di un Negozio di Videogiochi üéÆ

Sviluppare un sistema di gestione per un negozio di videogiochi che permetta di gestire prodotti di diverse tipologie, clienti e le loro vendite. Il programma deve utilizzare i concetti fondamentali di OOP.

## 1. EREDITA' E CLASSI ASTRATTE

Implementare una gerarchia di classi per i prodotti:

* Classe astratta `Prodotto` con attributi comuni (codice, titolo, prezzo, quantitaDisponibile)
* Classi concrete: `Videogioco`, `Console`, `Accessorio` (ereditano da `Prodotto`)
* Ogni tipo di prodotto deve avere specifiche proprie (piattaforma, genere, tipo, ecc.)

## 2. INTERFACCE

Implementare due interfacce:

* `Vendibile`: metodi `vendi(int quantita)`, `isDisponibile()`
* `Scontabile`: metodi `applicaSconto(double percentuale)`

Tutti i prodotti devono implementare `Vendibile` e `Scontabile`.

## 3. LETTURA E SCRITTURA FILE

* **Scrittura**: Salvare su file `.txt` o `.csv` l'elenco delle vendite effettuate con i dettagli (cliente, prodotto, quantit√†, prezzo totale)
* **Lettura**: Caricare da file le vendite pregresse all'avvio (gestire l'assenza del file)

## 4. POLIMORFISMO

* Implementare un metodo `mostraDettagli()` polimorfo in ogni classe `Prodotto` che restituisca informazioni specifiche della tipologia
* Usare una lista generica di `Prodotto` per memorizzare tutti i prodotti e invocare il metodo polimorfo su ciascuno

## 5. GESTIONE ECCEZIONI

* Eccezione personalizzata `QuantitaNonDisponibileException` se si tenta di vendere pi√π prodotti di quanti disponibili
* Eccezione personalizzata `ClienteNonValidoException` se i dati del cliente sono incompleti
* Eccezione per errori di lettura/scrittura file
* Gestire opportunamente `try-catch` nel programma principale

---

## STRUTTURA DEL PROGRAMMA

### Classi da implementare

```
Prodotto (classe astratta)
‚îú‚îÄ‚îÄ Videogioco
‚îú‚îÄ‚îÄ Console
‚îî‚îÄ‚îÄ Accessorio

Vendibile (interfaccia)
Scontabile (interfaccia)

Cliente
Vendita
Negozio (classe principale di gestione)
NegozioMain (classe con main per i test)
```

### Classe Prodotto (astratta)

* **Attributi**: codice, titolo, prezzo, quantitaDisponibile
* **Metodi**:
  * `vendi(int quantita)`: implementazione di `Vendibile`
  * `isDisponibile()`: implementazione di `Vendibile`
  * `applicaSconto(double percentuale)`: implementazione di `Scontabile`
  * `mostraDettagli()`: astratto
  * Getter e setter

### Classi concrete di Prodotto

#### Videogioco

* **Prezzo base**: variabile (da specificare)
* **Attributi specifici**:
  * `piattaforma: String` (es: "PlayStation 5", "Xbox Series X", "Nintendo Switch")
  * `genere: String` (es: "Azione", "RPG", "Sport")
  * `usato: boolean` (se √® usato, default false)
* **Metodo applicaSconto()**:
  * Se usato: sconto gi√† applicato del 30% sul prezzo base
  * Altrimenti: applica lo sconto richiesto normalmente
* **Metodo mostraDettagli()**: stampa codice, titolo, piattaforma, genere, prezzo, se √® usato
* **Metodo toString()**: formato "[Videogioco] Titolo - Piattaforma - ‚Ç¨X.XX"

#### Console

* **Prezzo base**: variabile (da specificare)
* **Attributi specifici**:
  * `marca: String` (es: "Sony", "Microsoft", "Nintendo")
  * `modello: String` (es: "PlayStation 5", "Xbox Series X")
  * `memoria: int` (capacit√† in GB, es: 512, 1024)
* **Metodo applicaSconto()**:
  * Le console hanno sconti limitati: massimo 10% di sconto
  * Se lo sconto richiesto √® maggiore del 10%, applica solo il 10%
* **Metodo mostraDettagli()**: stampa codice, titolo, marca, modello, memoria, prezzo
* **Metodo toString()**: formato "[Console] Marca Modello - Memoria GB - ‚Ç¨X.XX"

#### Accessorio

* **Prezzo base**: variabile (da specificare)
* **Attributi specifici**:
  * `tipo: String` (es: "Controller", "Cuffie", "Cavo HDMI")
  * `compatibilita: String` (es: "Universale", "PlayStation", "Xbox")
  * `wireless: boolean` (se √® wireless, default false)
* **Metodo applicaSconto()**:
  * Applica lo sconto richiesto normalmente
  * Se wireless: sconto massimo del 15%
* **Metodo mostraDettagli()**: stampa codice, titolo, tipo, compatibilit√†, se √® wireless, prezzo
* **Metodo toString()**: formato "[Accessorio] Tipo - Titolo - ‚Ç¨X.XX"

### Classe Cliente

* **Attributi**:
  * `nome: String`
  * `cognome: String`
  * `email: String`
  * `tessera: String` (codice tessera fedelt√†)
* **Metodi di validazione** (devono lanciare `ClienteNonValidoException`):
  * **Nome**: non null, non vuoto, almeno 2 caratteri
  * **Cognome**: non null, non vuoto, almeno 2 caratteri
  * **Email**: non null, non vuota, deve contenere "@" e "."
* **Metodi**:
  * `toString()`: formato "[Cliente] Nome Cognome - Email: email"
  * `equals()` e `hashCode()` (confronto basato su email)

### Classe Vendita

* **Attributi**: cliente, prodotto, quantita, prezzoTotale, dataVendita
* **Metodi**: toString() per la visualizzazione, metodo per salvare su file

### Classe Negozio

* **Attributi**: nome, lista di prodotti, lista di vendite
* **Metodi**:
  * `aggiungiProdotto(Prodotto p)`
  * `cercaProdotto(String titolo)`: ritorna prodotto con quel titolo
  * `creaVendita(Cliente c, Prodotto p, int quantita)`:
    * Verifica disponibilit√†, lancia `QuantitaNonDisponibileException` se quantit√† insufficiente
    * Verifica validit√† cliente, lancia `ClienteNonValidoException` se non valido
    * Crea vendita e aggiorna quantit√† prodotto
  * `caricaVenditeDaFile(String nomeFile)`: gestione eccezioni file
  * `salvaVenditeSuFile(String nomeFile)`: gestione eccezioni file
  * `visualizzaVendite()`
  * `visualizzaTuttiProdotti()`

### Eccezioni personalizzate

#### QuantitaNonDisponibileException

* **Utilizzata quando**: si tenta di vendere pi√π prodotti di quanti disponibili in magazzino
* **Messaggio suggerito**: "Quantit√† non disponibile per 'Titolo' (Richiesti: X, Disponibili: Y)"

#### ClienteNonValidoException

* **Utilizzata quando**: i dati del cliente non rispettano i criteri di validazione
* **Costruttore**:

  ```java
  public ClienteNonValidoException(String messaggio, String campo)
  ```

* **Campi di validazione falliti**:
  * "NOME" - se nome non valido
  * "COGNOME" - se cognome non valido
  * "EMAIL" - se email non valida
* **Messaggio suggerito**: "Errore nel campo CAMPO: messaggio specifico"

### Classe NegozioMain

Implementare un programma di test che:

1. **Crea un negozio** con 5 prodotti:
   * 2 Videogiochi (uno nuovo, uno usato)
   * 2 Console (diverse marche)
   * 1 Accessorio (wireless)
2. **Crea 3 clienti di test**:
   * Cliente 1: valido (es: "Marco Rossi", "<marco@email.com>", "FEDELTA001")
   * Cliente 2: valido (es: "Laura Bianchi", "<laura@email.com>", "FEDELTA002")
   * Cliente 3: NON valido (testare eccezione, es: email senza @)
3. **Tenta di creare il cliente non valido** e cattura `ClienteNonValidoException`
4. **Effettua 3 vendite valide**:
   * Vendita 1: Cliente 1, Videogioco nuovo, quantit√† 1
   * Vendita 2: Cliente 2, Console, quantit√† 1
   * Vendita 3: Cliente 1, Accessorio, quantit√† 2
5. **Applica sconti** ad alcuni prodotti:
   * Sconto 20% su videogioco
   * Sconto 15% su console (verr√† limitato al 10%)
6. **Tenta vendita con quantit√† non disponibile** e cattura `QuantitaNonDisponibileException`
7. **Salva le vendite su file** (`vendite.txt` o `vendite.csv`):
   * Gestire `IOException` se il salvataggio fallisce
   * Formato CSV: `Cliente,Prodotto,Quantita,PrezzoUnitario,PrezzoTotale,Data`
8. **Carica le vendite da file** e visualizza
9. **Visualizza tutti i prodotti** con i loro dettagli (polimorfismo)

**Output atteso**:

```
==== NEGOZIO VIDEOGIOCHI ====
[Creazione negozio e 5 prodotti]
[Creazione clienti]
ERRORE CATTURATO: Errore nel campo EMAIL: formato email non valido
[Applicazione sconti]
Sconto 20% applicato a: Videogioco X
Sconto limitato al 10% per: Console Y (massimo consentito)
[Creazione 3 vendite valide]
Vendita 1: Marco Rossi - Videogioco "Titolo" x1 - ‚Ç¨XX.XX
Vendita 2: Laura Bianchi - Console "Modello" x1 - ‚Ç¨XXX.XX
Vendita 3: Marco Rossi - Accessorio "Nome" x2 - ‚Ç¨XX.XX
ERRORE CATTURATO: Quantit√† non disponibile per 'Titolo' (Richiesti: 10, Disponibili: 2)
[Salvataggio vendite su file]
[Caricamento vendite da file]
[Visualizzazione dettagli di tutti i prodotti]
==== FINE TEST ====
```

---

## ESEMPIO DI IMPLEMENTAZIONE DEL MAIN

```java
public class NegozioMain {
    public static void main(String[] args) {
        System.out.println("==== NEGOZIO VIDEOGIOCHI ====\n");

        // 1. Creazione negozio
        Negozio negozio = new Negozio("GameWorld");

        // 2. Creazione prodotti
        System.out.println("[Creazione negozio e 5 prodotti]");
        Videogioco gioco1 = new Videogioco("VG001", "The Last of Us Part II", 69.99, 5, "PlayStation 5", "Azione", false);
        Videogioco gioco2 = new Videogioco("VG002", "FIFA 23", 39.99, 3, "PlayStation 5", "Sport", true);
        Console console1 = new Console("CN001", "PlayStation 5 Digital", 449.99, 2, "Sony", "PS5 Digital", 825);
        Console console2 = new Console("CN002", "Xbox Series S", 299.99, 4, "Microsoft", "Series S", 512);
        Accessorio acc1 = new Accessorio("AC001", "Controller DualSense", 69.99, 10, "Controller", "PlayStation", true);

        negozio.aggiungiProdotto(gioco1);
        negozio.aggiungiProdotto(gioco2);
        negozio.aggiungiProdotto(console1);
        negozio.aggiungiProdotto(console2);
        negozio.aggiungiProdotto(acc1);
        System.out.println("Prodotti aggiunti al catalogo.\n");

        // 3. Creazione clienti
        System.out.println("[Creazione clienti]");
        Cliente cliente1 = null;
        Cliente cliente2 = null;
        Cliente cliente3 = null;

        try {
            cliente1 = new Cliente("Marco", "Rossi", "marco@email.com", "FEDELTA001");
            System.out.println("Cliente 1 creato: " + cliente1);
        } catch (ClienteNonValidoException e) {
            System.out.println("ERRORE: " + e.getMessage());
        }

        try {
            cliente2 = new Cliente("Laura", "Bianchi", "laura@email.com", "FEDELTA002");
            System.out.println("Cliente 2 creato: " + cliente2);
        } catch (ClienteNonValidoException e) {
            System.out.println("ERRORE: " + e.getMessage());
        }

        // Cliente non valido - email senza @
        try {
            cliente3 = new Cliente("Paolo", "Verdi", "paoloemail.com", "FEDELTA003");
            System.out.println("Cliente 3 creato: " + cliente3);
        } catch (ClienteNonValidoException e) {
            System.out.println("ERRORE CATTURATO: " + e.getMessage());
        }
        System.out.println();

        // 4. Applicazione sconti
        System.out.println("[Applicazione sconti]");
        gioco1.applicaSconto(20.0);
        System.out.println("Sconto 20% applicato a: " + gioco1.getTitolo() + " - Nuovo prezzo: ‚Ç¨" +
                           String.format("%.2f", gioco1.getPrezzo()));

        console1.applicaSconto(15.0);
        System.out.println("Sconto 15% richiesto per: " + console1.getTitolo() +
                           " (limitato al 10% massimo) - Nuovo prezzo: ‚Ç¨" +
                           String.format("%.2f", console1.getPrezzo()));
        System.out.println();

        // 5. Creazione vendite valide
        System.out.println("[Creazione 3 vendite valide]");
        try {
            negozio.creaVendita(cliente1, gioco1, 1);
            System.out.println("Vendita 1: Marco Rossi - " + gioco1.getTitolo() + " x1 - ‚Ç¨" +
                               String.format("%.2f", gioco1.getPrezzo()));
        } catch (Exception e) {
            System.out.println("ERRORE: " + e.getMessage());
        }

        try {
            negozio.creaVendita(cliente2, console1, 1);
            System.out.println("Vendita 2: Laura Bianchi - " + console1.getTitolo() + " x1 - ‚Ç¨" +
                               String.format("%.2f", console1.getPrezzo()));
        } catch (Exception e) {
            System.out.println("ERRORE: " + e.getMessage());
        }

        try {
            negozio.creaVendita(cliente1, acc1, 2);
            System.out.println("Vendita 3: Marco Rossi - " + acc1.getTitolo() + " x2 - ‚Ç¨" +
                               String.format("%.2f", acc1.getPrezzo() * 2));
        } catch (Exception e) {
            System.out.println("ERRORE: " + e.getMessage());
        }
        System.out.println();

        // 6. Tentativo vendita con quantit√† non disponibile
        System.out.println("[Tentativo vendita con quantit√† eccessiva]");
        try {
            negozio.creaVendita(cliente2, gioco1, 10);
        } catch (QuantitaNonDisponibileException e) {
            System.out.println("ERRORE CATTURATO: " + e.getMessage());
        } catch (ClienteNonValidoException e) {
            System.out.println("ERRORE: " + e.getMessage());
        }
        System.out.println();

        // 7. Salvataggio vendite su file
        System.out.println("[Salvataggio vendite su file]");
        try {
            negozio.salvaVenditeSuFile("vendite.csv");
            System.out.println("Vendite salvate con successo su vendite.csv");
        } catch (IOException e) {
            System.out.println("ERRORE nel salvataggio: " + e.getMessage());
        }
        System.out.println();

        // 8. Caricamento vendite da file
        System.out.println("[Caricamento vendite da file]");
        try {
            negozio.caricaVenditeDaFile("vendite.csv");
            System.out.println("Vendite caricate con successo da vendite.csv");
        } catch (FileNotFoundException e) {
            System.out.println("ERRORE: File non trovato - " + e.getMessage());
        } catch (IOException e) {
            System.out.println("ERRORE nella lettura: " + e.getMessage());
        }
        System.out.println();

        // 9. Visualizzazione tutte le vendite
        System.out.println("[Visualizzazione vendite]");
        negozio.visualizzaVendite();
        System.out.println();

        // 10. Visualizzazione tutti i prodotti (polimorfismo)
        System.out.println("[Visualizzazione dettagli di tutti i prodotti - POLIMORFISMO]");
        negozio.visualizzaTuttiProdotti();

        System.out.println("\n==== FINE TEST ====");
    }
}
```

---

## ESEMPIO FILE CSV VENDITE

File: `vendite.csv`

```csv
Cliente,Prodotto,Quantita,PrezzoUnitario,PrezzoTotale,Data
Marco Rossi,The Last of Us Part II,1,55.99,55.99,2024-11-12
Laura Bianchi,PlayStation 5 Digital,1,404.99,404.99,2024-11-12
Marco Rossi,Controller DualSense,2,69.99,139.98,2024-11-12
```

### Spiegazione formato CSV

* **Cliente**: Nome completo del cliente (Nome Cognome)
* **Prodotto**: Titolo del prodotto venduto
* **Quantita**: Numero di unit√† vendute
* **PrezzoUnitario**: Prezzo per singola unit√† (con eventuali sconti gi√† applicati)
* **PrezzoTotale**: Prezzo totale della vendita (PrezzoUnitario √ó Quantita)
* **Data**: Data della vendita in formato YYYY-MM-DD

### Note per l'implementazione

Quando si salva su file, la classe `Negozio` dovrebbe:

1. Aprire il file in modalit√† scrittura
2. Scrivere la riga di intestazione (header)
3. Per ogni vendita, scrivere una riga con i dati separati da virgola
4. Gestire correttamente le eccezioni IOException

Quando si carica da file, la classe `Negozio` dovrebbe:

1. Verificare che il file esista (gestire FileNotFoundException)
2. Leggere la prima riga (header) e scartarla
3. Leggere ogni riga successiva e parsare i dati
4. Ricostruire gli oggetti Vendita con i dati letti
5. Gestire correttamente eventuali errori di formato
